<script src="/socket.io/socket.io.js"></script>
<link rel="import" href="https://polygit.org/components/polymer/polymer-element.html">

<dom-module id="dev-console">
  <template>
    <h3>Welcome, dev-console app user!</h3>
    <p>Live Connections: [[liveConnections]]</p>
    <p>Total Connections: [[totalConnections]]</p>
    <div id="consoleOut">

    </div>
  </template>
  <script>
  class DevConsole extends Polymer.Element {
  static get is() {
    return 'dev-console';
  }
  static get properties() {
    return {
      totalConnections: Number,
      liveConnections: Number
    };
  }
  connectedCallback() {
    super.connectedCallback();
    let socket = io();
    const consoleOutEle = this.$.consoleOut;

    socket.on('count', data => {
      this.liveConnections = data.live;
      this.totalConnections = data.total;
    });
    socket.on('rcon-out', data => {
      const newEntry = document.createElement('p');
      newEntry.innerHTML = JSON.stringify(data);
      consoleOutEle.appendChild(newEntry);
    });
  }
}

customElements.define(DevConsole.is, DevConsole);
</script>
</dom-module>
